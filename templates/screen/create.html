{% extends "base.html" %}

{% block content %}
<section class="screen-mode">
  <h1>üé¨ –≠–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º</h1>
  <p>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω—É, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É –∏ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –∏–≥—Ä–æ–∫–æ–≤.</p>

  {% if quizzes %}
  <form class="create-room-form" method="post" action="/screen/create-room">
    <label for="quiz_id">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</label>
    <select id="quiz_id" name="quiz_id" required>
      {% for quiz in quizzes %}
      <option value="{{ quiz.id }}">{{ quiz.title }}</option>
      {% endfor %}
    </select>

    <fieldset class="create-room-form__fieldset">
      <legend>–†–µ–∂–∏–º –∑–∞–ø—É—Å–∫–∞</legend>
      <label class="create-room-form__option">
        <input
          type="radio"
          name="start_mode"
          value="manual"
          checked
        />
        –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
      </label>
      <label class="create-room-form__option">
        <input type="radio" name="start_mode" value="auto" />
        –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø–æ —Ç–∞–π–º–µ—Ä—É
      </label>
    </fieldset>

    <div class="create-room-form__auto" data-element="auto-start-options" hidden>
      <label for="auto_start_delay">–ó–∞–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ (—Å–µ–∫—É–Ω–¥—ã)</label>
      <input
        type="number"
        id="auto_start_delay"
        name="auto_start_delay"
        min="0"
        step="1"
        inputmode="numeric"
        value="30"
      />
      <p class="create-room-form__hint" data-element="auto-start-hint">
        –ò–≥—Ä–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–∞–π–º–µ—Ä–∞. –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Ä–∞–Ω—å—à–µ
        –≤—Ä—É—á–Ω—É—é –∫–Ω–æ–ø–∫–æ–π –Ω–∏–∂–µ.
      </p>
    </div>

    <button type="submit" class="btn">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
  </form>
  {% else %}
  <p class="error">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∏–∫—Ç–æ—Ä–∏–Ω. –î–æ–±–∞–≤—å—Ç–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</p>
  {% endif %}
</section>

<script>
  (() => {
    const form = document.querySelector(".create-room-form");
    if (!form) {
      return;
    }

    const autoOptions = form.querySelector('[data-element="auto-start-options"]');
    const delayInput = form.querySelector('#auto_start_delay');

    const toggleAutoOptions = () => {
      const checked = form.querySelector('input[name="start_mode"]:checked');
      const isAuto = checked?.value === "auto";
      if (autoOptions) {
        autoOptions.hidden = !isAuto;
      }
      if (delayInput) {
        delayInput.toggleAttribute("required", Boolean(isAuto));
      }
    };

    form.querySelectorAll('input[name="start_mode"]').forEach((input) => {
      input.addEventListener("change", toggleAutoOptions);
    });

    toggleAutoOptions();
  })();
</script>
{% endblock %}
